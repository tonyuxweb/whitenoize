name: Deploy to GitHub Pages

on:
  push:
    branches: [main]  # Trigger sulla branch principale, puoi cambiare se necessario
  workflow_dispatch:  # Permette di avviare manualmente il workflow

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      # Checkout del codice dal repository
      - name: Checkout code
        uses: actions/checkout@v3

      # Set up Node.js (Astro richiede Node.js)
      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'  # Usa la versione di Node che desideri (consigliata >= 16)

      # Installa le dipendenze con pnpm
      - name: Install dependencies
        run: |
          npm install -g pnpm  # Installa pnpm globalmente
          pnpm install          # Installa le dipendenze del progetto

      # Costruisci il sito
      - name: Build site
        run: pnpm build

      # Imposta la directory di build per il deploy su GitHub Pages
      - name: Deploy to GitHub Pages
        uses: JamesIves/github-pages-deploy-action@v4.1.0
        with:
          branch: gh-pages  # La branch dove pubblicare il sito
          folder: dist      # La cartella che contiene i file costruiti da Astro
